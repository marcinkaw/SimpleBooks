{% extends "main/layout.html" %}

{% block content %}

<script language="javascript">

    $(document).ready(function () {
        $('#id_fromDate').datepicker({ dateFormat: 'dd.mm.yy' }).val();
        $('#id_toDate').datepicker({ dateFormat: 'dd.mm.yy' }).val();
    });

    function printClick(element) {
        $(element).attr('href', function() {
            itemsPerPage = $('#id_items_per_page').val();
            return this.href + itemsPerPage;
        });
    }

</script>

<form class="form-inline" method="POST" action="/main/report/edit/{{ report.id }}/">
  {% csrf_token %}
  {{ form }}
  <input type="submit" value="Aktualizuj"/>
</form>

<p>Dodaj do kasy: <a class="btn btn-success" href="{% url 'item_add' report.id %}">Dodaj wpis</a></p>

Pozycje w kasie:

<table class="table table-striped table-condensed">
    <thead>
        <tr>
            <td>
                Lp
            </td>
            <td>
                Numer<br />Data wystawienia
            </td>
            <td>
                Tytułem
            </td>
            <td>
                Kontrahent
            </td>
            <td>
                Przychód
            </td>
            <td>
                Rozchód
            </td>
            <td></td>
            <td></td>
        </tr>
    </thead>
    <tbody>
{% for item in items %}

        <tr>
            <td>
                {{ item.letter }}
            </td>
            <td>
                {{ item.number }}<br />{{ item.item_date_numeric }}
            </td>
            <td>
                {{ item.title }}
            </td>
            <td>
                {{ item.party }}
            </td>
            <td>
                {% if item.itemDirection == 'in' %}
                {{ item.amount }}
                {% endif %}
            </td>
            <td>
                {% if item.itemDirection == 'out' %}
                {{ item.amount }}
                {% endif %}
            </td>
            <td>
                <p><a class="btn btn-danger" href="{% url 'receipt_print_single' item.id %}">Drukuj dokument</a></p>
            </td>
            <td>
                <p><a class="btn btn-danger" href="{% url 'item_delete' report.id item.id %}">Usuń item</a></p>
            </td>
        </tr>

{% empty %}
No items.
{% endfor %}
    </tbody>
</table>

<p>Ilość wpisów na strone: <input id="id_items_per_page" type="number" min="1" max="25" value="20"></p>
<a onclick="printClick(this);" class="btn btn-danger" href="{% url 'report_print' report.id %}">Drukuj raport</a>
<a class="btn btn-danger" href="{% url 'receipt_print' report.id %}">Drukuj dokument kasowy</a>

{% endblock %}
